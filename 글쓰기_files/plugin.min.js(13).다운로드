!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=485)}({485:function(t,e,i){"use strict";i.r(e);var r=function(t){return void 0===t&&(t=""),t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n=function(t,e,i,n){var o;void 0===n&&(n=null),e.id="og_"+Date.now();var a=function(t){if(!t.type.startsWith("video"))return"";switch(!0){case/^(sandbox\-)|^(beta\-)?tv.kakao.com/.test(t.host):return"kakaotv";case/vimeo.com/.test(t.host):return"vimeo";case/www.youtube.com|youtu.be/.test(t.host):return"youtube";case/twitch.tv/.test(t.host)&&window.location.protocol.includes("https"):return"twitch"}}(t);if(a=i.indexOf(a)>-1?"":a){var s=function(t,e){void 0===e&&(e=860);var i={width:0,height:0};if(""!==t&&(t.split("?")[1].split("&").reduce(function(t,e){var i=e.split("=");return t[i[0]]=i[1],t},i),i.width>e)){var r=i.height/i.width;i.width=e,i.height=Math.round(i.width*r)}return i}(t.image&&t.image.length>0?t.image[0]:"",n);if(e.setAttribute("data-ke-type","video"),e.setAttribute("data-ke-mobilestyle","widthContent"),e.setAttribute("data-ke-style","alignCenter"),e.setAttribute("data-video-host",a),e.setAttribute("data-video-url",t.url),e.setAttribute("data-video-thumbnail",t.image),e.setAttribute("data-source-url",t.source_url),e.setAttribute("data-video-width",s.width),e.setAttribute("data-video-height",s.height),e.setAttribute("data-video-origin-width",s.width),e.setAttribute("data-video-origin-height",s.height),"twitch"===a){var d=t.source_url.includes("clip");e.setAttribute("data-is-twitch-clips",d)}o='<div class="video_content"><img width='+s.width+" height="+s.height+' src="'+t.image+'"></img></div>'}else e.setAttribute("data-ke-type","opengraph"),e.setAttribute("data-ke-align","alignCenter"),e.setAttribute("data-og-type",t.type),e.setAttribute("data-og-title",t.title),e.setAttribute("data-og-description",t.description),e.setAttribute("data-og-host",t.host),e.setAttribute("data-og-source-url",t.source_url),e.setAttribute("data-og-url",t.url),e.setAttribute("data-og-image",t.image),o=' \n      <a href="'+t.requested_url+'" target="_blank" data-source-url="'+t.source_url+'">\n        <div class="og-image" style="background-image:url('+t.image+')"></div>\n        <div class="og-text">\n          <p class="og-title">'+r(t.title)+'</p>\n          <p class="og-desc">'+r(t.description)+'</p>\n          <p class="og-host">'+t.host+"</p>\n        </div>\n      </a>\n    ";return o};function o(t,e,i){var r=t.dom.create("p");r.innerHTML='<br data-mce-bogus="1">',t.dom.insertAfter(r,i),e.setStart(r,0),e.setEnd(r,0),t.selection.setRng(e)}function a(t,e,i){if(e){var r=e.getAttribute("href"),n=r.startsWith("http")?r:"http://"+r,a=t.dom.getParent(t.selection.getNode(),"body > *");if(t.dom.is(a,"table"))o(t,i,e);else{if(a.nextSibling&&"FIGURE"===a.nextSibling.nodeName&&a.nextSibling.getAttribute("data-ke-type").startsWith("opengraph")){var d=a.nextSibling.querySelector("a")||a.nextSibling;if(d&&d.getAttribute("data-source-url")===n)return void o(t,i,a)}s(t,n,e,i)}}}function s(t,e,i,r,a){i||(i=t.selection.getNode(),r=t.selection.getSel().getRangeAt(0));var s=t.dom,d=document.createElement("figure");d.setAttribute("contenteditable","false"),d.className="og-loading",d.textContent="불러오는 중입니다...",s.insertAfter(d,s.getParent(i,"body > *, body > div > *")),d.nextSibling||o(t,r,d),t.settings.kOpengraph.fetch_handler(e,function(i){if(i.source_url&&""!==i.source_url||(i.source_url=e),0!==i.code)s.remove(d);else{a=a||(t.settings.video&&t.settings.video.service_name||"kakao_tv");var r=t.getBody().offsetWidth,o=r;t.settings.autoresize_overflow_padding&&(r-=2*t.settings.autoresize_overflow_padding),t.settings.video&&t.settings.video.max_width&&(o=Math.min(t.settings.video.max_width,r));var g=t.settings.kOpengraph.filters||[];d.innerHTML=n(i,d,g,o),d.removeAttribute("class");var u=d.getAttribute("data-video-host");u&&a&&"kakaotv"==u&&d.setAttribute("data-video-play-service",a)}t.undoManager.add()},function(t){var e=(0,s.$)(".og-loading",s.getRoot());e.length>0&&s.remove(e)})}var d,g=function(t){var e,i=t.startContainer,r=t.startOffset;if("A"===i.nodeName&&(e=i),"#text"!==i.nodeName){var n=r===i.childNodes.length?i.lastChild:i.childNodes[r];if(!n)return;"A"===n.nodeName?e=n:n.previousSibling&&"A"===n.previousSibling.nodeName?e=n.previousSibling:n.previousSibling&&n.previousSibling.previousSibling&&"A"===n.previousSibling.previousSibling.nodeName&&(e=n.previousSibling.previousSibling)}else"A"===i.parentNode.nodeName&&(e=i.parentNode),1===i.textContent.length&&i.textContent[0].search(/[\s]/)>-1&&i.previousSibling&&"A"===i.previousSibling.nodeName&&(e=i.previousSibling);return e},u=function(){function t(t){this.parserCommandPrefix="GetHTMLByCDM_",this.CDMTypeName="opengraph",this.parserCommand=this.parserCommandPrefix+this.CDMTypeName,this.editor=t}return t.prototype.register=function(){var t=this;this.editor.addCommand(this.parserCommand,function(e){var i=e.htmlArray,r=e.item,n=t.getHTMLStringByCDM(r.attribute);i.push(n)})},t.prototype.getFigureNode=function(t){var e=document.createElement("figure");return e.setAttribute("contenteditable","false"),e.setAttribute("data-ke-type",this.CDMTypeName),e.setAttribute("data-og-title",t.title),t.desc&&e.setAttribute("data-og-description",t.desc),e.setAttribute("data-og-host",t.host),e.setAttribute("data-og-source-url",t.sourceUrl),t.image&&e.setAttribute("data-og-image",t.image),e.setAttribute("data-og-url",t.url),e.setAttribute("data-ke-align",t.align),e},t.prototype.getOpengraphContentsNode=function(t){var e=document.createElement("a");e.setAttribute("href",t.url),e.setAttribute("target","_blank"),e.setAttribute("data-source-url",t.sourceUrl);var i=document.createElement("div");i.setAttribute("class","og-image"),t.image&&i.setAttribute("style","background-image:url("+t.image+")");var r=document.createElement("div");return r.setAttribute("class","og-text"),r.appendChild(this.getOpengraphItem("og-title",t.title)),t.desc&&r.appendChild(this.getOpengraphItem("og-desc",t.desc)),r.appendChild(this.getOpengraphItem("og-host",t.host)),e.appendChild(i),e.appendChild(r),e},t.prototype.getOpengraphItem=function(t,e){var i=document.createElement("p");return i.setAttribute("class",t),i.innerText=e,i},t.prototype.getHTMLStringByCDM=function(t){var e=this.getFigureNode(t),i=this.getOpengraphContentsNode(t);return e.appendChild(i),e.outerHTML},t}(),l=function(){function t(t){this.editor=t}return t.prototype.getFigureNode=function(){var t=this.editor.selection.getNode(),e=this.editor.$(t).closest("figure[data-ke-type]");return e&&e[0]?e:null},t.prototype.alignFloat=function(t){var e=this.getFigureNode();e[0]&&e.attr("data-ke-align",t)},t.prototype.register=function(t,e){this.editor.addCommand(e,this.alignFloat.bind(this,t))},t}(),c=function(t,e){var i=function(e){var i=this,r=function(){var e=t.$(t.selection.getNode()).closest("figure").attr("data-ke-align");i.active(i.settings.activestate==e)};r(),t.on("nodeChange",function(t){r()})};"alignLeft"===e?t.addButton("opengraphAlignLeft",{title:"Align left",cmd:"opengraphAlignLeft",icon:"imagealignleft",activestate:"alignLeft",onpostrender:i}):"alignCenter"===e?t.addButton("opengraphAlignCenter",{title:"Align center",cmd:"opengraphAlignCenter",icon:"imagealigncenter",activestate:"alignCenter",onpostrender:i}):"alignRight"===e&&t.addButton("opengraphAlignRight",{title:"Align right",cmd:"opengraphAlignRight",icon:"imagealignright",activestate:"alignRight",onpostrender:i})};!function(t){t.alignLeft="opengraphAlignLeft",t.alignCenter="opengraphAlignCenter",t.alignRight="opengraphAlignRight"}(d||(d={}));var p=function(){function t(t){this.editor=t,this.toolbarButtonArray=[],this.toolbarString=t.settings.kOpengraph&&t.settings.kOpengraph.toolbar,this.toolbarString&&(this.toolbarArray=this.toolbarString.split(" "),this.AlignAction=new l(this.editor))}return t.prototype.add=function(t){this.toolbarButtonArray.push(t)},t.prototype.predicate=function(t){return this.editor.dom.is(t,'figure[data-ke-type="opengraph"]')},t.prototype.register=function(){var t=this;if(!this.toolbarString)return!1;this.toolbarArray.forEach(function(e,i){d[e]?(t.AlignAction.register(e,d[e]),c(t.editor,e),t.add(d[e])):"|"===e&&t.add("|")}),this.editor.addContextToolbar(this.predicate.bind(this),this.toolbarButtonArray.join(" "))},t}(),h=function(t){var e=new p(t);new u(t).register();t.addCommand("makeOpengraph",function(){var e=t.selection.getSel().getRangeAt(0),i=g(e);a(t,i,e)}),t.addCommand("makeOpengraphWithUrl",function(e){s(t,e)}),t.addCommand("makeOpengraphWithKakaoTvService",function(e,i){s(t,e,null,null,i)}),t.on("PreProcess",function(e){var i=(0,t.dom.$)(".og-loading",e.node);i.length>0&&t.dom.remove(i)}),t.on("keyDown",function(e){var i=t.dom.$;if(13===e.keyCode){var r=t.selection.getSel().getRangeAt(0),n=g(r);!n||i(n).closest("td")[0]||/^tel:/.test(n.getAttribute("href"))||(e.preventDefault(),a(t,n,r))}}),t.on("init",function(){e.register()})};window.tinymce.PluginManager.add("kOpengraph",h)}});